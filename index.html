<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL チェッカー</title>
    <style>
        .url-list {
            margin: 20px 0;
        }
        .url-item {
            display: flex;
            align-items: center;
        }
        .status {
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <h1>URL チェッカー</h1>
    <div id="urlContainer" class="url-list">
        <!-- URLリストがここに挿入されます -->
    </div>

    <button onclick="showPopup()">次の10個を確認する</button>

    <script>
        const urlSource = 'https://zhjpwlj.github.io/proxylist/list.txt';
        let urlList = [];
        let currentIndex = 0;
        const increment = 10;

        async function fetchUrls() {
            try {
                const response = await fetch(urlSource);
                const text = await response.text();
                urlList = text.split('\n').map(url => url.trim()).filter(url => url);
                loadMoreUrls();
            } catch (error) {
                console.error('URLを取得できませんでした:', error);
            }
        }

        function loadMoreUrls() {
            const container = document.getElementById('urlContainer');
            container.innerHTML = ''; // 以前のURLをクリア
            for (let i = currentIndex; i < currentIndex + increment && i < urlList.length; i++) {
                const urlItem = document.createElement('div');
                urlItem.className = 'url-item';
                
                const urlLink = document.createElement('a');
                urlLink.href = urlList[i];
                urlLink.target = '_blank';
                urlLink.textContent = urlList[i];
                
                const status = document.createElement('span');
                status.className = 'status';
                status.textContent = '未確認';
                
                urlItem.appendChild(urlLink);
                urlItem.appendChild(status);
                container.appendChild(urlItem);
            }
            currentIndex += increment;
        }

        function showPopup() {
            const popupWindow = window.open('', 'popup', 'width=400,height=600');
            popupWindow.document.write('<h2>URLステータス確認</h2>');
            for (let i = currentIndex - increment; i < currentIndex && i < urlList.length; i++) {
                const url = urlList[i];
                popupWindow.document.write(`
                    <div>
                        <label>
                            <input type="checkbox" onclick="opener.saveStatus('${url}', this.checked)">
                            ${url}
                        </label>
                    </div>
                `);
            }
            popupWindow.document.write('<button onclick="window.close()">閉じる</button>');
        }

        function saveStatus(url, isChecked) {
            const status = isChecked ? 'アクセス可能' : 'ブロック';
            document.querySelectorAll('.url-item').forEach(item => {
                const link = item.querySelector('a');
                if (link.href === url) {
                    item.querySelector('.status').textContent = status;
                }
            });
            document.cookie = `${url}=${status}; path=/`;
        }

        // 初回ロード
        fetchUrls();
    </script>
</body>
</html>
